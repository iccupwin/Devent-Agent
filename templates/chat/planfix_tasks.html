{% extends 'base.html' %}

{% block title %}–ó–∞–¥–∞—á–∏ Planfix{% endblock %}

{% block content %}
<div class="container">
    <!-- Header Section -->
    <div class="page-header">
        <h1>–ó–∞–¥–∞—á–∏ Planfix</h1>
        <p class="subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏ –∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏</p>
    </div>

    <!-- Table Container -->
    <div class="table-container">
        <!-- Table Header -->
        <div class="table-header">
            <h2 class="table-title">–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á</h2>
            <div class="table-actions">
                <div class="search-container">
                    <input type="text" id="task-search" class="search-input" placeholder="–ü–æ–∏—Å–∫ –∑–∞–¥–∞—á...">
                    <button class="search-button">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                        </svg>
                    </button>
                </div>

                <div class="filters-container">
                    <select id="status-filter" class="filter-select">
                        <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                        <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</option>
                        <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</option>
                    </select>

                    <select id="project-filter" class="filter-select">
                        <option value="all">–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã</option>
                    </select>

                    <select id="page-size" class="filter-select">
                        <option value="25">25 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ</option>
                        <option value="50">50 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ</option>
                        <option value="100">100 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ</option>
                    </select>

                    <button id="refresh-button" class="btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M23 4v6h-6"></path>
                            <path d="M1 20v-6h6"></path>
                            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                        </svg>
                        –û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                </div>
            </div>
        </div>

        <!-- Table -->
        <table class="tasks-table">
            <thead>
                <tr>
                    <th class="sortable" data-sort="id">ID</th>
                    <th class="sortable" data-sort="name">–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                    <th class="sortable" data-sort="status">–°—Ç–∞—Ç—É—Å</th>
                    <th class="sortable" data-sort="project">–ü—Ä–æ–µ–∫—Ç</th>
                    <th class="sortable" data-sort="dates">–î–∞—Ç—ã</th>
                    <th class="sortable" data-sort="assignee">–ü–æ—Å—Ç–∞–Ω–æ–≤—â–∏–∫</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody id="tasks-table-body">
                <!-- Tasks will be loaded here dynamically -->
            </tbody>
        </table>

        <!-- Empty State -->
        <div id="empty-state" class="table-empty" style="display: none;">
            <div class="table-empty-icon">üìã</div>
            <p>–ù–µ—Ç –∑–∞–¥–∞—á –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</p>
        </div>

        <!-- Table Pagination -->
        <div class="table-pagination">
            <div class="pagination-info">
                –ü–æ–∫–∞–∑–∞–Ω–æ <span id="shown-from">0</span> - <span id="shown-to">0</span> –∏–∑ <span id="total-count">0</span>
            </div>
            <div class="pagination-buttons">
                <button id="prev-page" class="pagination-btn" disabled>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                </button>
                <div id="pagination-pages" class="pagination-pages">
                    <!-- Pagination pages will be added here dynamically -->
                </div>
                <button id="next-page" class="pagination-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Task Modal -->
<div id="taskModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modalTaskTitle">–ó–∞–¥–∞—á–∞</h2>
            <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <div class="task-info">
                <div class="info-row">
                    <span class="info-label">ID:</span>
                    <span id="modalTaskId"></span>
                </div>
                <div class="info-row">
                    <span class="info-label">–ü—Ä–æ–µ–∫—Ç:</span>
                    <span id="modalTaskProject"></span>
                </div>
                <div class="info-row">
                    <span class="info-label">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏:</span>
                    <span id="modalTaskAssignee"></span>
                </div>
                <div class="info-row">
                    <span class="info-label">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:</span>
                    <span id="modalTaskPriority"></span>
                </div>
                <div class="info-row">
                    <span class="info-label">–°—Ç–∞—Ç—É—Å:</span>
                    <span id="modalTaskStatus"></span>
                </div>
                <div class="info-row">
                    <span class="info-label">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞:</span>
                    <span id="modalTaskDateStart"></span>
                </div>
                <div class="info-row">
                    <span class="info-label">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è:</span>
                    <span id="modalTaskDateEnd"></span>
                </div>
            </div>
            <div class="task-description">
                <h3>–û–ø–∏—Å–∞–Ω–∏–µ</h3>
                <div id="modalTaskDescription"></div>
            </div>
        </div>
        <div class="modal-footer">
            <button id="modalIntegrateButton" class="btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
                –û–±—Å—É–¥–∏—Ç—å —Å Claude
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/planfix-tasks.js"></script>
{% endblock %} 